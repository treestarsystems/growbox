---
- name: Install required packages on target systems
  hosts: all
  become: true

  vars:
   packages_list:
    - ansible
    - build-essential
    - git
    - golang-go
    - iputils-ping
    - minicom
    - nano
    - net-tools
    - p7zip-full
    - screen
    - telnet
    - tftp-hpa:armhf
    - tftpd-hpa
    - ufw
    - vlan
    - wget

  tasks:
   - name: Update apt cache
     ansible.builtin.apt:
      update_cache: true
      cache_valid_time: 3600

   - name: Install all required packages
     ansible.builtin.apt:
      name: "{{ packages_list }}"
      state: present
     register: install_result

   - name: Display installation result
     ansible.builtin.debug:
      msg: "Packages installed successfully"
     when: install_result is success
